{"mappings":"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","sources":["src/js/api-catalog-page.js"],"sourcesContent":["import axios from 'axios';\nimport {genres, fullStar, halfStar, emptyStar, \n        heroFragment, topMoviesFragment, \n        pagesBtnStartup, emptyApiResponeHero, \n        emptyApiResponeCatalog} from './api-html-fragment.js'\n\nconst params = {\n  page: 1,\n  language: 'en-US',\n  api_key: '682127ed972e56f6bb70ae743d23c1d7',\n};\nconst options = {\n  method: 'GET',\n  headers: {\n    accept: 'application/json',\n    Authorization: `Bearer ${params.api_key}`,\n  },\n};\n\nconst urls = {\n\n  urlDay: `https://api.themoviedb.org/3/trending/movie/day`,\n  urlWeek: `https://api.themoviedb.org/3/trending/movie/week`,\n  urlSearch:`https://api.themoviedb.org/3/search/movie`,\n  url:``,\n  title:``,\n  quantity: 20,\n};\n\nconst generateStars = rating => {\n    let fullStars = Math.floor(rating);\n    let halfStars = rating % 1 >= 0.5 ? 1 : 0;\n    let emptyStars = 5 - fullStars - halfStars;\n    return `${fullStar.repeat(fullStars)}${halfStar.repeat(\n      halfStars\n    )}${emptyStar.repeat(emptyStars)}`;\n  };\n  \nconst createHeroMovie = resResponse => {\n    const maxLength = 200;\n    const heroSection = document.querySelector('#hero');\n    const randomMovieIndex = Math.floor(Math.random() * resResponse.data.results.length);\n    const topDayMovie = resResponse.data.results[randomMovieIndex];\n    \n    const cutText = (text, maxLength) => text.length > maxLength ? text.slice(0, maxLength) + '...' : text;\n    const truncatedOverview = cutText(topDayMovie.overview, maxLength);\n    const rating = topDayMovie.vote_average / 2;\n    const starsHTML = generateStars(rating);\n\n    heroSection.innerHTML =heroFragment(topDayMovie.id, topDayMovie.backdrop_path, topDayMovie.title, starsHTML, truncatedOverview)\n  };\n\n\nconst movieGenresCompare = (arr1, arr2) => {\n\tconst finalArr = [];\n\tfor (i = 0; i < arr1.length; i += 1) {\n\t\t\t\tif (arr2.includes(arr1[i].id)) {\n\t\t\t\t\tfinalArr.push(arr1[i].name)\n\t\t\t\t}\n\t\t\t}\n\treturn finalArr.slice(0,2).join(\", \");\n}\n\nconst catalogItem = (movie) =>{\n    const movieGenres = movieGenresCompare(genres, movie.genre_ids)\n    const releaseYear = movie.release_date.slice(0, 4);\n    const rating = movie.vote_average / 2;\n    const starsHTML = generateStars(rating);\n    return topMoviesFragment(movie.id, movie.backdrop_path, movie.title, movieGenres, releaseYear, starsHTML)\n}\nconst emptyResponseCatalog = ()=>{\n    const moviesCatalog = document.querySelector('#catalogSection');\n    catalogSection.innerHTML = emptyApiResponeCatalog\n}\nconst crateCatalog = (movies)=>{\n    const moviesCatalog = document.querySelector('#catalg');\n    let weekMoviesSectionFragment=\"\"\n    movies.forEach( (movie) =>{ \n        weekMoviesSectionFragment = weekMoviesSectionFragment + catalogItem(movie)\n    });\nmoviesCatalog.innerHTML=weekMoviesSectionFragment\n}\nconst createPagesBtn =(totalItems, itemsPerPage) =>{\n    const pagesBtnSection = document.querySelector('#pagesBtnSection');\n    const lastPage = Math.ceil(totalItems / itemsPerPage)\n    if(lastPage<2) return\n\n    pagesBtnSection.innerHTML=pagesBtnStartup(lastPage)\n   \n}\n  function createDefaultHeroSection() {\n    const heroSection = document.querySelector('#hero');\n    heroSection.innerHTML = emptyApiResponeHero;}\n\nconst catalogPageApiData = url =>\n  axios\n    .get(url, { params, ...options })\n    .then(resResponse => {\n        const length=resResponse.data.results.length\n        //const length = 0\n        if (url.includes('day')) {\n            \n            if (length===0){\n               createDefaultHeroSection()\n               return;\n            }\n            createHeroMovie(resResponse)\n            return;\n        }\n        if (length===0){\n            emptyResponseCatalog()\n            return;\n          }\n          urls.url=url\n        crateCatalog(resResponse.data.results)\n        createPagesBtn(resResponse.data.total_results, 20)\n        return;\n    })\n    .catch(error => {\n        emptyResponseCatalog()\n        createDefaultHeroSection()\n      return console.log(error)});\n\nconst catalogPageContent = async () => \n    await Promise.all([\n        catalogPageApiData(urls.urlDay),\n        catalogPageApiData(urls.urlWeek)\n      ]);\n\ncatalogPageContent();\n\n\nconst PageApiData = url =>\n    axios\n        .get(url, { params, ...options })\n        .then(resResponse => {\n            const length=resResponse.data.results.length\n            //obsługa gdy pojawi się błąd null z document.querySelector('#catalg')\n            if (document.querySelector('#catalg').hasChildNodes()) {\n                const childs = document.querySelectorAll(\"#catalg > li\");\n                childs.forEach(child => child.remove());\n            }\n            if (document.querySelector('#navForm')!==null)\n                document.querySelector(\"#navForm\").remove();\n            \n\n             if (length===0){\n                emptyResponseCatalog()\n                return;\n              }\n              console.log(resResponse)\n            crateCatalog(resResponse.data.results)\n            createPagesBtn(resResponse.data.total_results, 20)\n            return;\n        })\n        .catch(error => {\n            emptyResponseCatalog()\n            return console.log(error)});\n\n\nwindow.addEventListener(\"click\" , event=>{\n    console.log(event.target.parentElement.id)\n    \n    try {\n        if (event.target.id ===\"searchBtn\") {\n            event.preventDefault();\n            console.log(document.querySelector('#catalogFormInput').value.trim())\n            if (document.querySelector('#catalogFormInput').value.trim()==\"\") {\n                 return\n             }\n            urls.url=`https://api.themoviedb.org/3/search/movie`\n            params.page=1\n            urls.title= document.querySelector('#catalogFormInput').value.trim()\n\n            const searchUrl=`${urls.url}?query=${urls.title}&include_adult=false` \n\n            const PageContent = async () => await PageApiData(searchUrl)\n            PageContent();\n            console.log(urls)\n        }\n        if (event.target.parentElement.id ===\"navForm\") {\n            event.preventDefault();\n            params.page=event.target.textContent\n            let navUrl= urls.url\n            if(navUrl.includes(\"search\")){\n                navUrl=navUrl+`?query=${urls.title}&include_adult=false`\n                console.log(navUrl)\n            }\n            const PageContent = async () => await PageApiData(navUrl)\n            \n            PageContent();\n\n        }\n\n    } catch (error) {\n    console.error(error);\n    }\n\n    \n} )\n\n\n\n\n\n\n    // try {\n    //     if (event.target.parentElement.id ===\"navForm\"){\n    //         console.log(event.target.textContent)\n\n\n\n\n\n\n\n\n    //     }\n    //   } catch (error) {\n    //     console.error(\"ID is not define!\");\n    //   }\n      \n\n        \n\n\n\n\n"],"names":["$2shzp","parcelRequire","$63f816236bb60c84$var$params","page","language","api_key","$63f816236bb60c84$var$options","method","headers","accept","Authorization","$63f816236bb60c84$var$urls","urlDay","urlWeek","urlSearch","url","title","quantity","$63f816236bb60c84$var$generateStars","rating","fullStars","Math","floor","halfStars","emptyStars","$94Fp6","fullStar","repeat","halfStar","emptyStar","$63f816236bb60c84$var$catalogItem","movie","movieGenres","arr1","arr2","finalArr","i","length","includes","id","push","name","slice","join","$63f816236bb60c84$var$movieGenresCompare","genres","genre_ids","releaseYear","release_date","vote_average","starsHTML","topMoviesFragment","backdrop_path","$63f816236bb60c84$var$emptyResponseCatalog","document","querySelector","catalogSection","innerHTML","emptyApiResponeCatalog","$63f816236bb60c84$var$crateCatalog","movies","moviesCatalog","weekMoviesSectionFragment","forEach","$63f816236bb60c84$var$createPagesBtn","totalItems","itemsPerPage","pagesBtnSection","lastPage","ceil","pagesBtnStartup","$63f816236bb60c84$var$createDefaultHeroSection","emptyApiResponeHero","$63f816236bb60c84$var$catalogPageApiData","default","get","then","resResponse","data","results","heroSection","randomMovieIndex","random","topDayMovie","truncatedOverview","text","overview","maxLength","heroFragment","$63f816236bb60c84$var$createHeroMovie","total_results","catch","error","console","log","async","Promise","all","$63f816236bb60c84$var$catalogPageContent","$63f816236bb60c84$var$PageApiData","hasChildNodes","querySelectorAll","child","remove","window","addEventListener","event","target","parentElement","preventDefault","value","trim","searchUrl","PageContent","textContent","navUrl"],"version":3,"file":"catalog.6c5ecc70.js.map"}