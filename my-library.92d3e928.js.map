{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-22611f639d91c413.js","src/js/modal.js","node_modules/@parcel/runtime-js/lib/runtime-643dfc921be0cb37.js","src/js/btn-state.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"Ujaud\\\":\\\"my-library.92d3e928.js\\\",\\\"lp5u4\\\":\\\"sprite.5d6e6df3.svg\\\"}\"));","import APIService from './api-service';\nimport sprite from '../images/sprite.svg';\nimport BtnState from './btn-state';\nimport { checkStorage } from './my-library';\n\nconst apiService = new APIService();\n\nconst catalog = document.getElementById('catalg');\nconst myLibGallery = document.getElementById('mylibraryMovielist');\nconst weeklyTrends = document.getElementById('catalogMovielist');\nconst modalWindow = document.querySelector('.modal-film');\nconst overlay = document.querySelector('.overlay');\n\naddModalListener(catalog);\naddModalListener(weeklyTrends);\naddModalListener(myLibGallery);\n\nfunction addModalListener(listRef) {\n  if (!listRef) {\n    return;\n  }\n  listRef.addEventListener('click', onMovieCardClick);\n}\n\nasync function onMovieCardClick(e) {\n  if (!e.target.closest('.movielist-item')) {\n    return;\n  }\n\n  try {\n    const movieID = e.target.closest('.movielist-item').getAttribute('data-id');\n    const movieData = await apiService.getMovieInfo(movieID);\n    const markup = createMarkup(movieData);\n    updateModal(markup);\n    const btnModalClose = document.querySelector('.modal-film__close');\n    btnModalClose.addEventListener('click', closeModalWindows);\n    openModal();\n    const toLibraryBtn = document.getElementById('mylibrary');\n    const btnApi = new BtnState(toLibraryBtn, 'modal-btn-attr', movieData);\n    btnApi.setBtnState();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction openModal() {\n  /* const lockPaddingValue = window.innerWidth - document.body.offsetWidth + 'px'; */\n\n  modalWindow.classList.remove('hidden');\n  overlay.classList.remove('hidden');\n  /* document.body.style.paddingRight = lockPaddingValue; */\n  document.body.style.overflow = 'hidden';\n}\n\nfunction updateModal(markup) {\n  modalWindow.innerHTML = markup;\n}\n\nfunction createMarkup({\n  id,\n  poster_path,\n  title,\n  overview,\n  popularity,\n  vote_average,\n  vote_count,\n  genres,\n}) {\n  const getMoivePoster = getPoster(poster_path);\n  function getPoster(poster_path) {\n    /* if (poster_path === null || !poster_path) {\n      return `src='${comingSoonImg}'`;\n    } */\n    return `srcset=\"\n                https://image.tmdb.org/t/p/w500/${poster_path} 500w,\n                https://image.tmdb.org/t/p/w300/${poster_path} 342w,\n                https://image.tmdb.org/t/p/w185/${poster_path} 185w\"\n        src=\"https://image.tmdb.org/t/p/w500/${poster_path}\"\n\n        \" sizes=\" (min-width: 768px) 500px, (min-width: 480px) 342px, (min-width: 320px) 185px, 100vw\"   \n    `;\n  }\n\n  return `<div class=\"modal-film__container\" data-id=${id}>\n  <button class=\"modal-film__close\">\n    <svg width=\"18\" height=\"18\" class=\"modal-film__close-icon\">\n    <use href=\"${sprite}#icon-close2\"></use>       \n</svg>\n  </button>\n  <img ${getMoivePoster} loading=\"lazy\" alt=\"movie-poster\" class=\"modal-film__img\" />\n  <div class=\"modal-film__card\">\n    <h2 class=\"modal-film__title\">${title}</h2>\n    <div class=\"modal-film__blok\">\n      <ul class=\"modal-film__list attribute\">\n        <li class=\"modal-film__link\">Vote / Votes</li>\n        <li class=\"modal-film__link\">Popularity</li>\n        <li class=\"modal-film__link\">Genre</li>\n      </ul>\n\n      <ul class=\"modal-film__list\">\n        <li class=\"modal-film__link-item item-votes\">\n          <div class=\"vote\">${vote_average}</div>\n          &nbsp;/&nbsp;\n          <div class=\"votes\">${vote_count}</div>\n        </li>\n        <li class=\"modal-film__link-item popularity\">${popularity}</li>\n        <li class=\"modal-film__link-item genres\">${genres\n          .map(g => g.name)\n          .join(', ')}</li>\n      </ul>\n    </div>\n    <h3 class=\"modal-film__about\">ABOUT</h3>\n    <p class=\"modal-film__about-txt\">${overview}\n    </p>\n    <button class=\"btn\" id=\"mylibrary\" data-action=\"add\">Add to my library</button>`;\n}\n\nfunction closeModalWindows() {\n  modalWindow.classList.add('hidden');\n  overlay.classList.add('hidden');\n  /* document.body.style.paddingRight = '0px'; */\n  document.body.style.overflow = 'auto';\n  checkStorage();\n}\n\noverlay.addEventListener('click', closeModalWindows);\nwindow.addEventListener('keydown', function (e) {\n  if (e.key === 'Escape' && !modalWindow.classList.contains('hidden')) {\n    closeModalWindows();\n  }\n});\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"lp5u4\")).toString();","import LibraryAPI from './library-functions';\n\nconst library = new LibraryAPI();\n\nlibrary.setLibrary();\n\nexport default class BtnState {\n  constructor(btn, btnStateStorageKey, movie) {\n    this.btn = btn;\n    this.btnStateStorageKey = btnStateStorageKey;\n    this.movie = movie;\n  }\n\n  setBtnState() {\n    const isInLibrary = library.movies.some(m => m.id === this.movie.id);\n    if (isInLibrary) {\n      this.btn.setAttribute('data-action', 'remove');\n      this.btn.textContent = 'Remove from library';\n      // console.log(isInLibrary);\n    } else {\n      this.btn.setAttribute('data-action', 'add');\n      this.btn.textContent = 'Add to library';\n      // console.log(isInLibrary, 'else');\n    }\n\n    this.btn.addEventListener('click', () => {\n      if (this.btn.getAttribute('data-action') === 'add') {\n        this.toAdd();\n      } else {\n        this.toRemove();\n        //   console.log('Callback:', this.fetchFunction);\n      }\n    });\n  }\n\n  toAdd() {\n    library.addMovie(this.movie);\n    this.btn.removeEventListener('click', this.toAdd);\n    this.btn.setAttribute('data-action', 'remove');\n    localStorage.setItem(this.btnStateStorageKey, 'remove');\n    this.btn.textContent = 'Remove from library';\n    //   console.log(this.btn.getAttribute('data-action'));\n  }\n\n  toRemove() {\n    library.deleteMovie(this.movie);\n    this.btn.removeEventListener('click', this.toRemove);\n    this.btn.setAttribute('data-action', 'add');\n    localStorage.setItem(this.btnStateStorageKey, 'add');\n    this.btn.textContent = 'Add to library';\n    //   console.log(this.btn.getAttribute('data-action'));\n  }\n}\n"],"names":["$ef7689007096c8a0$export$6503ec6e8aabbaf","$ef7689007096c8a0$export$f7ad0328861e2f03","$ef7689007096c8a0$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$7me8F","$a4212a039eccdb43$exports","URL","resolve","import","meta","url","toString","$0f0a2b4861d8fd80$var$library","default","setLibrary","$0f0a2b4861d8fd80$export$2e2bcd8739ae039","constructor","btn","btnStateStorageKey","movie","this","setBtnState","movies","some","m","setAttribute","textContent","addEventListener","getAttribute","toAdd","toRemove","addMovie","removeEventListener","localStorage","setItem","deleteMovie","$8a7e756c566dd1ea$var$apiService","$8a7e756c566dd1ea$var$catalog","document","getElementById","$8a7e756c566dd1ea$var$myLibGallery","$8a7e756c566dd1ea$var$weeklyTrends","$8a7e756c566dd1ea$var$modalWindow","querySelector","$8a7e756c566dd1ea$var$overlay","$8a7e756c566dd1ea$var$addModalListener","listRef","$8a7e756c566dd1ea$var$onMovieCardClick","async","e","target","closest","movieID","movieData","getMovieInfo","markup","innerHTML","$8a7e756c566dd1ea$var$updateModal","poster_path","poster_path1","title","overview","popularity","vote_average","vote_count","genres","getMoivePoster","getPoster","$parcel$interopDefault","map","g","name","join","$8a7e756c566dd1ea$var$createMarkup","$8a7e756c566dd1ea$var$closeModalWindows","classList","remove","body","style","overflow","toLibraryBtn","error","console","log","add","$Iwkks","checkStorage","window","key","contains"],"version":3,"file":"my-library.92d3e928.js.map"}