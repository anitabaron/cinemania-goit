{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/helpers/bundle-url.js","node_modules/@parcel/runtime-js/lib/runtime-d3badcb8f545d08c.js","src/js/modal.js","node_modules/@parcel/runtime-js/lib/runtime-bebc5d4d89cdd986.js","src/js/btn-state.js","<<jsx-config-pragma.js>>"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","\"use strict\";\n\nvar bundleURL = {};\n\nfunction getBundleURLCached(id) {\n  var value = bundleURL[id];\n\n  if (!value) {\n    value = getBundleURL();\n    bundleURL[id] = value;\n  }\n\n  return value;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|(chrome|moz)-extension):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      // The first two stack frames will be this function and getBundleURLCached.\n      // Use the 3rd one, which will be a runtime in the original bundle.\n      return getBaseURL(matches[2]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|(chrome|moz)-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  var matches = ('' + url).match(/(https?|file|ftp|(chrome|moz)-extension):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"dxLsE\\\":\\\"my-library.0a012124.js\\\",\\\"ee16w\\\":\\\"sprite.5d6e6df3.svg\\\"}\"));","import APIService from './api-service';\nimport sprite from '../images/sprite.svg';\nimport BtnState from './btn-state';\nimport { checkStorage } from './my-library';\n\nconst apiService = new APIService();\n\nconst catalog = document.getElementById('catalg');\nconst myLibGallery = document.getElementById('mylibraryMovielist');\nconst weeklyTrends = document.getElementById('catalogMovielist');\nconst modalWindow = document.querySelector('.modal-film');\nconst overlay = document.querySelector('.overlay');\n\naddModalListener(catalog);\naddModalListener(weeklyTrends);\naddModalListener(myLibGallery);\n\nfunction addModalListener(listRef) {\n  if (!listRef) {\n    return;\n  }\n  listRef.addEventListener('click', onMovieCardClick);\n}\n\nasync function onMovieCardClick(e) {\n  if (!e.target.closest('.movielist-item')) {\n    return;\n  }\n\n  try {\n    const movieID = e.target.closest('.movielist-item').getAttribute('data-id');\n    const movieData = await apiService.getMovieInfo(movieID);\n    const markup = createMarkup(movieData);\n    updateModal(markup);\n    const btnModalClose = document.querySelector('.modal-film__close');\n    btnModalClose.addEventListener('click', closeModalWindows);\n    openModal();\n    const toLibraryBtn = document.getElementById('mylibrary');\n    const btnApi = new BtnState(toLibraryBtn, 'modal-btn-attr', movieData);\n    btnApi.setBtnState();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction openModal() {\n  /* const lockPaddingValue = window.innerWidth - document.body.offsetWidth + 'px'; */\n\n  modalWindow.classList.remove('hidden');\n  overlay.classList.remove('hidden');\n  /* document.body.style.paddingRight = lockPaddingValue; */\n  document.body.style.overflow = 'hidden';\n}\n\nfunction updateModal(markup) {\n  modalWindow.innerHTML = markup;\n}\n\nfunction createMarkup({\n  id,\n  poster_path,\n  title,\n  overview,\n  popularity,\n  vote_average,\n  vote_count,\n  genres,\n}) {\n  const getMoivePoster = getPoster(poster_path);\n  function getPoster(poster_path) {\n    /* if (poster_path === null || !poster_path) {\n      return `src='${comingSoonImg}'`;\n    } */\n    return `srcset=\"\n                https://image.tmdb.org/t/p/w500/${poster_path} 500w,\n                https://image.tmdb.org/t/p/w300/${poster_path} 342w,\n                https://image.tmdb.org/t/p/w185/${poster_path} 185w\"\n        src=\"https://image.tmdb.org/t/p/w500/${poster_path}\"\n\n        \" sizes=\" (min-width: 768px) 500px, (min-width: 480px) 342px, (min-width: 320px) 185px, 100vw\"   \n    `;\n  }\n\n  return `<div class=\"modal-film__container\" data-id=${id}>\n  <button class=\"modal-film__close\">\n    <svg width=\"18\" height=\"18\" class=\"modal-film__close-icon\">\n    <use href=\"${sprite}#icon-close2\"></use>       \n</svg>\n  </button>\n  <img ${getMoivePoster} loading=\"lazy\" alt=\"movie-poster\" class=\"modal-film__img\" />\n  <div class=\"modal-film__card\">\n    <h2 class=\"modal-film__title\">${title}</h2>\n    <div class=\"modal-film__blok\">\n      <ul class=\"modal-film__list attribute\">\n        <li class=\"modal-film__link\">Vote / Votes</li>\n        <li class=\"modal-film__link\">Popularity</li>\n        <li class=\"modal-film__link\">Genre</li>\n      </ul>\n\n      <ul class=\"modal-film__list\">\n        <li class=\"modal-film__link-item item-votes\">\n          <div class=\"vote\">${vote_average}</div>\n          &nbsp;/&nbsp;\n          <div class=\"votes\">${vote_count}</div>\n        </li>\n        <li class=\"modal-film__link-item popularity\">${popularity}</li>\n        <li class=\"modal-film__link-item genres\">${genres\n          .map(g => g.name)\n          .join(', ')}</li>\n      </ul>\n    </div>\n    <h3 class=\"modal-film__about\">ABOUT</h3>\n    <p class=\"modal-film__about-txt\">${overview}\n    </p>\n    <button class=\"btn\" id=\"mylibrary\" data-action=\"add\">Add to my library</button>`;\n}\n\nfunction closeModalWindows() {\n  modalWindow.classList.add('hidden');\n  overlay.classList.add('hidden');\n  /* document.body.style.paddingRight = '0px'; */\n  document.body.style.overflow = 'auto';\n  checkStorage();\n}\n\noverlay.addEventListener('click', closeModalWindows);\nwindow.addEventListener('keydown', function (e) {\n  if (e.key === 'Escape' && !modalWindow.classList.contains('hidden')) {\n    closeModalWindows();\n  }\n});\n","module.exports = require('./helpers/bundle-url').getBundleURL('dxLsE') + require('./helpers/bundle-manifest').resolve(\"ee16w\");","import LibraryAPI from './library-functions';\n\nconst library = new LibraryAPI();\n\nlibrary.setLibrary();\n\nexport default class BtnState {\n  constructor(btn, btnStateStorageKey, movie) {\n    this.btn = btn;\n    this.btnStateStorageKey = btnStateStorageKey;\n    this.movie = movie;\n  }\n\n  setBtnState() {\n    const isInLibrary = library.movies.some(m => m.id === this.movie.id);\n    if (isInLibrary) {\n      this.btn.setAttribute('data-action', 'remove');\n      this.btn.textContent = 'Remove from library';\n      // console.log(isInLibrary);\n    } else {\n      this.btn.setAttribute('data-action', 'add');\n      this.btn.textContent = 'Add to library';\n      // console.log(isInLibrary, 'else');\n    }\n\n    this.btn.addEventListener('click', () => {\n      if (this.btn.getAttribute('data-action') === 'add') {\n        this.toAdd();\n      } else {\n        this.toRemove();\n        //   console.log('Callback:', this.fetchFunction);\n      }\n    });\n  }\n\n  toAdd() {\n    library.addMovie(this.movie);\n    this.btn.removeEventListener('click', this.toAdd);\n    this.btn.setAttribute('data-action', 'remove');\n    localStorage.setItem(this.btnStateStorageKey, 'remove');\n    this.btn.textContent = 'Remove from library';\n    //   console.log(this.btn.getAttribute('data-action'));\n  }\n\n  toRemove() {\n    library.deleteMovie(this.movie);\n    this.btn.removeEventListener('click', this.toRemove);\n    this.btn.setAttribute('data-action', 'add');\n    localStorage.setItem(this.btnStateStorageKey, 'add');\n    this.btn.textContent = 'Add to library';\n    //   console.log(this.btn.getAttribute('data-action'));\n  }\n}\n",null],"names":["$0380ce8f1f064ccc$export$6503ec6e8aabbaf","$0380ce8f1f064ccc$export$f7ad0328861e2f03","$0380ce8f1f064ccc$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","$7dd1ddf6834435ca$export$bdfd709ae4826697","$7dd1ddf6834435ca$var$bundleURL","$7dd1ddf6834435ca$var$getBaseURL","url","replace","value","err","matches","stack","match","$7dd1ddf6834435ca$var$getBundleURL","parcelRequire","register","JSON","parse","$bpxeT","$051a3e25b6535369$exports","getBundleURL","resolve","$8MBJY","$618a31414ae81877$var$library","default","setLibrary","$618a31414ae81877$export$2e2bcd8739ae039","BtnState","btn","btnStateStorageKey","movie","this","key","movies","some","m","_this","setAttribute","textContent","addEventListener","getAttribute","toAdd","toRemove","addMovie","removeEventListener","localStorage","setItem","deleteMovie","$40873ecf3c18e122$var$apiService","$1h2Gi","$40873ecf3c18e122$var$catalog","document","getElementById","$40873ecf3c18e122$var$myLibGallery","$40873ecf3c18e122$var$weeklyTrends","$40873ecf3c18e122$var$modalWindow","querySelector","$40873ecf3c18e122$var$overlay","$40873ecf3c18e122$var$addModalListener","listRef","$40873ecf3c18e122$var$onMovieCardClick","e","$40873ecf3c18e122$var$_onMovieCardClick","apply","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","movieID","movieData","toLibraryBtn","target","closest","getMovieInfo","_ctx","sent","$40873ecf3c18e122$var$updateModal","$40873ecf3c18e122$var$createMarkup","$40873ecf3c18e122$var$closeModalWindows","$40873ecf3c18e122$var$openModal","setBtnState","console","log","t0","classList","remove","body","style","overflow","markup","innerHTML","param","poster_path","poster_path1","title","overview","popularity","vote_average","vote_count","genres","getMoivePoster","concat","map","g","name","join","add","$g4hZ6","checkStorage","window","contains"],"version":3,"file":"my-library.0a012124.js.map"}